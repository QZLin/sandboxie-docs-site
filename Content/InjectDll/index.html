<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Inject Dll - Sandboxie Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Inject Dll";
        var mkdocs_page_input_path = "Content\\InjectDll.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="https://avatars.githubusercontent.com/u/63755826?size=64" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Sandboxie documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Help Topics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../HelpTopics/">Help Topics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../GettingStarted/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UsageTips/">Usage Tips</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Sandboxie Control</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../SandboxieControl/">Sandboxie Control</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../FileMenu/">File Menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ViewMenu/">View Menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SandboxMenu/">Sandbox Menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ConfigureMenu/">Configure Menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../HelpMenu/">Help Menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../TrayIconMenu/">Tray Icon Menu</a>
                </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../KnownConflicts/">Known Conflicts</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Topics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../AdvancedTopics/">Advanced Topics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SandboxHierarchy/">Sandbox Hierarchy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../PrivacyConcerns/">Privacy Concerns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ServicePrograms/">Service Programs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ResourceAccessMonitor/">Resource Access Monitor (for Sandboxie Classic)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../PlusContent/TraceLog/">Trace logging (for Sandboxie Plus)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../HowToUseWinDbg/">How To Use Win Dbg</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Sandboxie Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Inject Dll</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="inject-dll">Inject Dll</h1>
<p><em>InjectDll</em> is a sandbox setting in <a href="../SandboxieIni/">Sandboxie Ini</a>. It tells Sandboxie to "inject" some DLL into every program in the sandbox. "Inject" means the DLL is</p>
<pre><code>   .
   .
   .
   [DefaultBox]
   InjectDll=c:\Program Files\Sandboxie Utilities\Sample.dll
</code></pre>
<p>You should specify a full path to the DLL. If the DLL file itself resides within the sandbox, specify the full path inside the sandbox.</p>
<p><strong>Note:</strong> The InjectDll setting specifies 32-bit DLLs, and will be ignored in a 64-bit process on 64-bit Windows. Use the <a href="../InjectDll64/">InjectDll64</a> setting to specify 64-bit DLLs.</p>
<hr />
<p>The order of DLLs loaded into the sandboxed program is thus:</p>
<p>Ntdll.dll<br />
KernelBase.dll (only on Windows 7)<br />
Kernel32.dll<br />
SbieDll.dll (on 64-bit Windows, this can be either the 64-bit SbieDll or the 32-bit SbieDll)<br />
<em>InjectDlls</em> (loaded in the order specified in Sandboxie.ini)<br />
Optionally, ShimEng (or AppHelp on Windows 7) and related DLLs<br />
All <a href="https://msdn.microsoft.com/en-us/library/ms684184(VS.85).aspx">statically-linked</a> DLLs</p>
<p>The behavior described above applies to Sandboxie version 3.46 and later. Earlier versions of Sandboxie implemented a different behavior which is described below:</p>
<p>The injected DLL is loaded into the sandboxed process (or program) after all the statically-linked DLLs are loaded and initialized, but before the program itself begins to execute at its entry point.</p>
<hr />
<p>If the DLL exports the symbol <strong>InjectDllMain</strong> or <strong>InjectDllMain@8</strong>, Sandboxie will call this procedure after the DLL is loaded, and pass the address of the SbieDll module. Declare InjectDllMain in your code:</p>
<pre><code>   __declspec(dllexport) void __stdcall InjectDllMain(
      HINSTANCE hSbieDll, ULONG_PTR UnusedParameter);
</code></pre>
<p>It is recommended to use the <strong>hSbieDll</strong> parameter as the module instance handle for SbieDll.Dll, instead of relying on GetModuleHandle("SbieDll.dll"). This makes it possible for the injected DLL to interact with SbieDll.dll regardless of the actual name used for SbieDll.dll. However, using LoadLibrary or GetModuleHandle to look up SbieDll by name is also fine.</p>
<hr />
<p>At this time, this setting cannot be manipulated from <a href="../SandboxieControl/">Sandboxie Control</a>. You have to manually edit it into <a href="../SandboxieIni/">Sandboxie Ini</a>.</p>
<p>See also: <a href="../InjectDll64/">InjectDll64</a>, <a href="../SBIEDLLAPI/">SBIE DLL API</a>, <a href="../StartCommandLine/">Start Command Line</a>.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
